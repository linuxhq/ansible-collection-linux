---
- name: Prepare
  hosts: all
  tasks:
    - name: Ensure packages are present
      ansible.builtin.package:
        name:
          - "{{ 'python' ~ _python ~ '-requests' }}"
          - sudo
        state: present
      vars:
        _python: "{{ '3' if ansible_distribution_major_version | int > 7 else '2' }}"
...
